\documentclass[b5paper]{book}
\usepackage[
    b5paper,
		margin=2cm,
	]{geometry}
\setlength\parindent{0em}
\setlength{\parskip}{1em}

\usepackage{booktabs}
\usepackage{blindtext}

%-----------%
% XREF DICT %
%-----------%

\usepackage{pgfkeys}
\pgfkeyssetvalue{/xref dict/fig}{Figure}
\pgfkeyssetvalue{/xref dict/eq}{Equation}
\pgfkeyssetvalue{/xref dict/eqs}{Equations}
\pgfkeyssetvalue{/xref dict/tab}{Table}
\pgfkeyssetvalue{/xref dict/def}{Definition}
\pgfkeyssetvalue{/xref dict/note}{Note}
\pgfkeyssetvalue{/xref dict/challange}{Challange}
\pgfkeyssetvalue{/xref dict/example}{Example}

%----------%
% GRAPHICS %
%----------%

\usepackage{caption}
\usepackage{subcaption}

\usepackage{tikz}
\usepackage{tikzpagenodes}
\usetikzlibrary{positioning, calc, decorations.pathreplacing, decorations.text}

\tikzset{
	arrow/.style={thick, ->, >=stealth},
	vector/.style={very thick, ->, >=stealth},
}

\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween, colormaps, colorbrewer}
\pgfplotsset{
		compat=1.16,
		every axis/.append style={
			font=\small,
		},
		graph2d/.style={
		axis x line=middle,
		axis y line=middle,
		every axis x label/.style={
			at={(ticklabel* cs:1.01)},
			anchor=west,
		},
		every axis y label/.style={
			at={(ticklabel* cs:1.01)},
			anchor=south,
		},
		axis line style={stealth-stealth, thick},
		label style={font=\large},
		xlabel=$x$,
		ylabel=$y$,
		tick label style={font=\small},
		samples=200,
		grid=both,
		grid style={line width=.1pt, draw=gray!20},
		major grid style={line width=.2pt,draw=gray!50},
		minor tick num=4,
	},
	function/.style={line width=1.5pt},
}

%-------%
% FONTS %
%-------%

\usepackage{kpfonts}

%--------%
% COLORS %
%--------%

\usepackage{xcolor}
\usepackage{colortbl}
\definecolor{xblue}{HTML}{4268BD}
\definecolor{xred}{HTML}{BD4242}
\definecolor{xgreen}{HTML}{52B256}
\definecolor{xpurple}{HTML}{7F52B2}
\definecolor{xorange}{HTML}{FF9F31}
\definecolor{xdotted}{HTML}{999999}

% Document-specific colors
\colorlet{normaltextcolor}{black}
\colorlet{figtextcolor}{xblue}

%------- %
% XHFILL %
%------- %

\usepackage{xhfill}

%---------------%
% CHAPTER TITLE %
%---------------%

% Used to set chapter title look.
% "explicit" is there so we can
% use the first parameter (#1).
\usepackage[explicit]{titlesec}
\newcommand{\chapternumsize}{\fontsize{70}{70}\selectfont}
\newcommand{\chaptertitlesize}{\fontsize{30}{30}\selectfont}

\titleformat{\chapter}{\sffamily\bfseries}{}{0pt}{
	\centering
	\begin{tikzpicture}[font=\sffamily\bfseries]
		\fill[black!10, rounded corners] (0,0) rectangle (5cm,5cm);
		\node (chapternum) at (2.5cm,4.5cm) {\fontsize{85}{85}\selectfont\thechapter};
		\node[below of=chapternum, yshift=-2cm] {\includegraphics[scale=1.5]{figures/chapters/tapir_rainbow.pdf}};
		\node[align=center, below of=chapternum, yshift=-5cm] {\fontsize{30}{30}\selectfont\uppercase{#1}};
		\node[align=center, above of=chapternum, yshift=5mm] {\huge CHAPTER};
	\end{tikzpicture}
}

\titleformat{\section}{\sffamily\Large\bfseries}{\huge{\thesection}}{1em}{\uppercase{#1}}

\titleformat{\subsection}{\sffamily\large\bfseries}{}{0em}{\uppercase{#1}}

%------------%
% REFERENCES %
%------------%
\usepackage{chngcntr}
\counterwithin{table}{chapter}
\counterwithin{figure}{chapter}
\renewcommand{\eqref}[1]{
	Equation \ref{eq:#1}
}
\newcommand{\tabref}[1]{
	\textbf{\textcolor{xblue}{Table} \ref{tab:#1}}
}
\newcommand{\figref}[1]{
	\textbf{\textcolor{xblue}{Figure} \ref{fig:#1}}
}
\newcommand{\noteref}[1]{
	\textbf{\textcolor{xred}{Note} \ref{note:#1}}
}
\newcommand{\exampleref}[1]{
	\textbf{\textcolor{xblue}{Example} \ref{example:#1}}
}

%---------%
% HEADERS %
%---------%

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}% Clear header/footer
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter:\ #1}{}}
\fancyhead[RO,LE]{\leftmark}% Chapter details in book
\fancyfoot[RO,LE]{\thepage}
\makeatother

%-------%
% BOXES %
%-------%

\usepackage{fontawesome}
\usepackage[most]{tcolorbox}
\tcbset{
	common/.style={
		lower separated=false,
		coltitle=white,
		colback=gray!5,
		boxrule=0.5pt,
		fonttitle=\bfseries,
		enhanced,
		breakable,
		top=8pt,
		before skip=8pt,
		attach boxed title to top left={
			yshift=-0.25cm,
		xshift=0.38cm},
		boxed title style={
			boxrule=0pt,
			colframe=white,
			arc=0pt,
		outer arc=0pt},
	separator sign={~~},},
	defstyle/.style={
		common,
		colframe=xpurple,
		colback=xpurple!5,
		colbacktitle=xpurple,
		overlay unbroken and last={
			\node[anchor=south east, outer sep=0pt] at (\linewidth-width, 0) {
	\textcolor{xpurple}{$\pi$}};}},
	exmplstyle/.style={
		common,
		colframe=xblue,
		colback=xblue!5,
		colbacktitle=xblue,
		overlay unbroken and last={
			\node[anchor=south east, outer sep=0pt, font=\large\bfseries] at (\linewidth-width, 1) {
	\textcolor{xblue}{\faArrowCircleDown}};}},
	notestyle/.style={
		common,
		colframe=xred,
		colback=xred!5,
		colbacktitle=xred,
		overlay unbroken and last={
			\node[anchor=south east, outer sep=0pt, font=\large\bfseries] at (\linewidth-width, 1) {
	\textcolor{xred}{!}};}},
	chllngstyle/.style={
		common,
		colframe=xgreen,
		colback=xgreen!5,
		colbacktitle=xgreen,
		overlay unbroken and last={
			\node[anchor=south east, outer sep=0pt, font=\large\bfseries] at (\linewidth-width, 0) {
	\textcolor{xgreen}{?}};}},
	thmstyle/.style={
		common,
		colframe=second,
		colback=second!5,
		colbacktitle=second,
		overlay unbroken and last={
			\node[anchor=south east, outer sep=0pt] at (\linewidth-width,0) {
	\textcolor{second}{$\heartsuit$}};}},
	theoremstyle/.style={
		common,
		colframe=xpurple,
		colback=xpurple!5,
		colbacktitle=xpurple,
		overlay unbroken and last={
			\node[anchor=south east, outer sep=0pt, font=\large\bfseries] at (\linewidth-width, 1) {
	\textcolor{xpurple}{$\multimapdotbothA$}};}},
}
\newtcbtheorem[auto counter, number within=chapter]{definition}{Definition}{defstyle}{def}
\newtcbtheorem[auto counter, number within=chapter]{example}{Example}{exmplstyle}{example}
\newtcbtheorem[auto counter, number within=chapter]{note}{Note}{notestyle}{note}
\newtcbtheorem[auto counter, number within=chapter]{challange}{Challange}{chllngstyle}{challange}
\newtcbtheorem[auto counter, number within=chapter]{theorem}{Theorem}{theoremstyle}{theorem}

%---------%
% FIGURES %
%---------%

\usepackage{float}
\usepackage{caption}
\usepackage[colorlinks=true, linkcolor=xblue]{hyperref}

% Caption label
\DeclareCaptionLabelSeparator{doublespace}{\ \ }
\captionsetup{labelfont={color=xblue,bf}, figurename=Figure, labelsep=doublespace}

% Refs format
\newcommand{\xref}[2][fig]{
	\color{figtextcolor}\textbf{\pgfkeysvalueof{/xref dict/#1}}~\ref{#1:#2} \color{normaltextcolor}
}

%-------------------%
% HIGHLIGHTED WORDS %
%-------------------%

\usepackage{imakeidx}
\usepackage{marginnote}
\makeindex
\renewcommand\emph[1]{\color{xpurple}{\textbf{#1}}\color{normaltextcolor}\index{#1}}%\marginnote[#1]{}

%-------%
% MATHS %
%-------%

\usepackage{amsmath, bm}
\numberwithin{equation}{chapter}
\usepackage{siunitx}
\newcommand{\Rs}[1]{\mathbb{R}^{#1}}
%\newcommand{\true}{\colorbox{xblue!25}{true}}
%\newcommand{\false}{\colorbox{xred!25}{false}}
\newcommand{\true}{\textcolor{xblue}{\textbf{true}}}
\newcommand{\false}{\textcolor{xred}{\textbf{false}}}
\newcommand{\AND}{\textbf{AND}}
\newcommand{\OR}{\textbf{OR}}
\newcommand{\opand}{\wedge}
\newcommand{\opor}{\vee}
\newcommand{\falseprop}[1]{
	\begingroup
	\color{xred}
	\underset{\false}{#1}
	\endgroup
}
\newcommand{\trueprop}[1]{
	\begingroup
	\color{xblue}
	\underset{\true}{#1}
	\endgroup
}
\newcommand{\defeq}{:=}
\newcommand{\eqdef}{=:}
\newcommand{\conj}[1]{\overline{#1}}

%-------------%
% OTHER STUFF %
%-------------%

\usepackage[version=4]{mhchem} % for chemistry
\newcommand{\shrug}[1][]{% shrug emoji
	\begin{tikzpicture}[baseline,x=0.8\ht\strutbox,y=0.8\ht\strutbox,line width=0.125ex,#1]
		\def\arm{(-2.5,0.95) to (-2,0.95) (-1.9,1) to (-1.5,0) (-1.35,0) to (-0.8,0)};
		\draw \arm;
		\draw[xscale=-1] \arm;
		\def\headpart{(0.6,0) arc[start angle=-40, end angle=40,x radius=0.6,y radius=0.8]};
		\draw \headpart;
		\draw[xscale=-1] \headpart;
		\def\eye{(-0.075,0.15) .. controls (0.02,0) .. (0.075,-0.15)};
		\draw[shift={(-0.3,0.8)}] \eye;
		\draw[shift={(0,0.85)}] \eye;
% draw mouth
		\draw (-0.1,0.2) to [out=15,in=-100] (0.4,0.95);
\end{tikzpicture}
}

%----------%
% DOCUMENT %
%----------%

\begin{document}

% Chapters
\setcounter{chapter}{-1}

% Introduction
\input{chapters/intro/preface.tex}
%\input{chapters/intro/math_symbols_sets.tex}
%\input{chapters/intro/relations_functions.tex}
%\input{chapters/intro/polynomials.tex}
%\input{chapters/intro/exponentials_logarithms.tex}
%\input{chapters/intro/trigonomentry.tex}
\input{chapters/intro/complex_numbers.tex}

\end{document}
